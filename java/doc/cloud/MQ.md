# MQ

> 异步通信

## 初识 MQ

### 事件驱动

> broker

- 优点
  - 低耦合
  - 吞吐量上升
    - 某些事件需要做的事情变少
  - 故障隔离
  - 流量削峰
- 缺点
  - 依赖 broker
  - 不好追踪管理

### 什么是 MQ(broker)

> 消息队列

- 市场上有多种 MQ 的解决方案

  - 各自有不同的性能处理情况

- 发布者
- 中间人
  - 通道
  - 队列
  - 分组
    - 权限
    - 虚拟 host
- 订阅者

### SpringAMQP

> 主要是简化 RabbitMQ 原生写法

- 基本用法

  - 通过配置文件和@AutoWrite 之后, 可以很优雅的处理发送消息
  - 监听消息通过 `@RabbitListener(queue = 'name')`
    - 注意最上面要加上 @Component
    - 方法内部接受消息
    - 无法回溯

- 一个发布者 两个消费者

  > 提高消息处理效率

  - 通过配置可以控制获取发布消息的内容

- 存在 `exchange`(交换机)
  > 队列和交换机之间需要进行绑定
  - Fanout(广播)
    - 一个发布, 每个消费者都能接收到
  - Direct(路由)
    - 发布到指定的消费者
    - 每次发送需要一个 `bindingKey`
  - Topic(话题)
    - 存在通配符,进行规则绑定
    - 其它的和 Direct 一般无二

### 消息转换器

> MQ 发送的消息是一个 Object 类型, 可以很多样化,

- 注意: 可以自己进行一个内容的解析和获取
